/*
 * Pre-load necessary database. (Will be organized up as a class)
 * 
 */

/* 
 * File:   preload.h
 * Author: caojianr
 *
 * Created on January 30, 2017, 6:31 PM
 */

#include <vector>
#include <unordered_map>
#include <algorithm>
#include "m1.h"
#include "StreetsDatabaseAPI.h"
#include <boost/geometry/index/rtree.hpp>
#include <boost/geometry.hpp>
#include <boost/geometry/core/cs.hpp>
#include <boost/geometry/geometries/point.hpp>
#include <boost/geometry/geometries/box.hpp>

using namespace std;
//r-tree
namespace bg = boost::geometry;
namespace bgi = boost::geometry::index;
typedef bg::model::point<double, 2, bg::cs::cartesian> point;
typedef bg::model::box<point> box;
typedef std::pair<box, unsigned> value;

#ifndef PRELOAD_H
#define PRELOAD_H
void street_ids_preload(unordered_map <string, vector<unsigned>> & street_ids_map);
void street_street_segments_preload(vector<vector<unsigned>> & street_street_segments);
void street_intersections_preload(vector<vector<unsigned>> & street_intersections);
void street_segment_length_preload(vector <double> & street_segment_length);
void street_length_preload(vector <double> & street_length);
void speed_limit_preload(vector <double> & speed_limit);
void curve_point_count_preload(vector <unsigned> & curve_point);
void street_id_preload(vector <StreetIndex> & street_id);
void intersection_street_segments_preload(vector<vector<unsigned>> & id0_intersection_street_segments);
double quick_find_distance(LatLon point1, LatLon point2, double lat_avg);
double cos_lat_avg_CI();
double cos_lat_avg_POI();
bgi::rtree<value, bgi::rstar<10> >  closest_intersection_preload();
bgi::rtree<value, bgi::rstar<10> >  closest_point_of_interest_preload();
#endif /* PRELOAD_H */
